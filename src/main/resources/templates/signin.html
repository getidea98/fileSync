<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:v-on="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <title>FileSync</title>
    <script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://cdn.bootcss.com/vue/2.6.11/vue.min.js"></script>
    <script src="https://cdn.bootcss.com/axios/0.19.2/axios.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap-theme.min.css">
</head>
<body>
<div class="row">
    <div class="col-md-4"></div>
    <div class="col-md-4" id="app">
<!--        <form action="/login">-->
            <h1 style="text-align: center">请登录</h1>
            <div class="input-group input-group-lg" style="margin-bottom: 10px">
                <span class="input-group-addon">账户</span>
                <input type="text" class="form-control" placeholder="account" aria-describedby="sizing-addon1"
                       id="account" name="account">
            </div>
            <div class="input-group input-group-lg" style="margin-bottom: 10px">
                <span class="input-group-addon">密码</span>
                <input type="text" class="form-control" placeholder="password" aria-describedby="sizing-addon1"
                       id="password" name="password">
            </div>
            <div class="btn-group" style="margin-left: 190px">
                <input th:type="hidden" th:id="platform" th:value="web" name="platform">
                <button type="submit" class="btn btn-default" @click="goProFile">登录</button>
            </div>
<!--        </form>-->
    </div>
    <div class="col-md-4"></div>
</div>
<script>
    new Vue({
        el: '#app',
        methods: {
            goProFile: function () {
                let params = {
                    "account": $('#account').val(),
                    "password": $("#password").val(),
                    "platform": $("#platform").val()
                };
                axios.post('http://localhost:8080/login',
                    JSON.stringify(params),
                    {
                        headers: {"Content-Type": "application/json;charset=UTF-8"}
                    })
                    .then(response => {
                        if(response.data != null){
                            this.$router.push("/profile");
                        }
                    })
                    .catch(function (error) { // 请求失败处理
                        console.log(error);
                    });
            },
            profile: function () {
                window.location.href="http://localhost:8080/profile?account="+$('#account').val()+"&password="+$("#password").val()+"&platform="+$("#platform").val();
            }
        }
    })
</script>
</body>
</html>